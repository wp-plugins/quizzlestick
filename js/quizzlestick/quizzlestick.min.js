!function(e){var t={quiz:function(t){var i=t;return this.each(function(){var t,s,n,r,a,u,c,l,o,d,z,p=e(this),f=i||p.data("quizzlestick");if(f=e.extend(!0,{},e.fn.quizzlestick.defaults,f),p.data({quizzlestick:f,initialised:!0}),f.id&&f.api.send({id:f.id,action:"config"},f),p.addClass("quizzlestick quizzlestick-"+f.type+" "+f.classname).on("start",f.onstart).on("complete",f.oncomplete).on("answer",f.onanswer).on("correct",f.oncorrect).on("incorrect",f.onincorrect).on("timer",f.ontimer).on("next",f.onnext).on("prev",f.onprev).on("ready",f.onready).on("tap click",".quizzlestick-start",function(e){e.preventDefault(),p.data("started")||p.data("complete")||(p.data("started",!0),z=setInterval(function(){f.state.time+=1e3,r.html(p.fumanchu("{{templates.timer}}",f)),p.trigger("qstimer",[f.state.time,f]),f.state.time>=f.timelimit&&(f.mustanswer=!1,p.find(".quizzlestick-finish").click())},1e3),u.addClass("quizzlestick-hidden").hide(),t.show().removeClass("quizzlestick-hidden"),p.trigger("qsstart",[z,f]))}).on("tap click",".quizzlestick-check",function(t){if(t.preventDefault(),!p.data("complete")){console.log("here");var i,r=p.find(".quizzlestick-current"),a=r.find(".quizzlestick-answer"),u=r.find(".quizzlestick-result"),z=r.find(".quizzlestick-selected"),m=r.data("id"),q=f.questions[m];r.data("answered")||(c.addClass("quizzlestick-hidden").hide(),r.addClass("quizzlestick-answered").data("answered",!0),f.state.question=m,q.total++,f.state.answers[m]||(f.state.answers[m]=[]),z.each(function(){var t=e(this),i=t.data("id"),s=q.answers[i];f.state.answers[m].push(i),s.total++,t.find(".quizzlestick-answer-total").html(s.total),t.data("total",s.total),s.correct?(f.state.points+=parseInt(s.points,10),"which"!==f.type&&(t.addClass("quizzlestick-correct"),s.resultcorrect&&u.append(p.fumanchu(s.resultcorrect,s)))):(t.addClass("quizzlestick-incorrect"),s.resultincorrect&&u.append(p.fumanchu(s.resultincorrect,s)))}),i=e.grep(q.correct,function(t){return e.inArray(t,f.state.answers[m])>-1}).length,a.each(function(){e.inArray(e(this).data("id"),q.correct)>=0&&"which"!==f.type&&e(this).addClass("quizzlestick-correct")}),"single"===f.type?(i?(r.addClass("quizzlestick-question-correct"),q.resultcorrect?u.append(p.fumanchu(q.resultcorrect,q,f)):q.result&&u.append(p.fumanchu(q.result,q,f)),u.prepend(p.fumanchu(f.templates.correct,q,f)),p.trigger("qscorrect",[i,r,q,f])):(r.addClass("quizzlestick-question-incorrect"),q.resultincorrect?u.append(p.fumanchu(q.resultincorrect,q,f)):q.result&&u.append(p.fumanchu(q.result,q,f)),u.prepend(p.fumanchu(f.templates.incorrect,q,f)),p.trigger("qsincorrect",[i,r,q,f])),u.append(p.fumanchu(f.templates.nextprev,q,f)),l=p.find(".quizzlestick-next").eq(0),o=p.find(".quizzlestick-prev").eq(0),d=p.find(".quizzlestick-finish").eq(0)):"which"===f.type&&(u.append(p.fumanchu(f.templates.nextprev,q,f)),l=p.find(".quizzlestick-next").eq(0),o=p.find(".quizzlestick-prev").eq(0),d=p.find(".quizzlestick-finish").eq(0)),""!==e.trim(u.html())&&"which"!==f.type&&u.removeClass("quizzlestick-hidden"),n.html(p.fumanchu("{{templates.progress}}",f)),p.trigger("qsanswer",[i,r,q,f]),f.api.send({id:f.id,action:"answer",question:m,correct:i,state:f.state},f),f.helpers.numanswers({},f)>=s.length?f.nextdelay?setTimeout(function(){d.click()},f.nextdelay):r.find(".quizzlestick-finish").show().removeClass("quizzlestick-hidden"):f.nextdelay?setTimeout(function(){l.click()},f.nextdelay):f.mustanswer&&s.length>1&&l.add(r.find(".quizzlestick-next")).show().removeClass("quizzlestick-hidden"))}}).on("tap click",".quizzlestick-next",function(e){if(e.preventDefault(),!p.data("complete")){if(f.helpers.numanswers({},f)>=s.length)return void d.click();{var t=p.find(".quizzlestick-current"),i=t.next(),r=t.data("id");f.questions[r]}s.removeClass("quizzlestick-question-prev quizzlestick-question-next quizzlestick-current"),t.removeClass("quizzlestick-current").addClass("quizzlestick-question-prev"),f.state.question<s.length&&(f.state.question=r+1,n.html(p.fumanchu("{{templates.progress}}",f)),i.addClass("quizzlestick-current").next().addClass("quizzlestick-question-next"),p.trigger("qsnext",[i,s,f]))}}).on("tap click",".quizzlestick-prev",function(e){if(e.preventDefault(),!p.data("complete")){if(f.helpers.numanswers({},f)>=s.length)return void d.click();{var t=p.find(".quizzlestick-current"),i=t.prev(),r=t.data("id");f.questions[r]}s.removeClass("quizzlestick-question-prev quizzlestick-question-next quizzlestick-current"),t.removeClass("quizzlestick-current quizzlestick-question-prev").addClass("quizzlestick-question-next"),f.state.question>0&&(confid.state.question=r-1,n.html(p.fumanchu("{{templates.progress}}",f)),i.addClass("quizzlestick-current").prev().addClass("quizzlestick-question-prev"),p.trigger("qsprev",[i,s,f]))}}).on("tap click",".quizzlestick-answer",function(t){if(t.preventDefault(),!p.data("complete")){var i=e(this),n=e(this).parents(".quizzlestick-question"),r=(n.find(".quizzlestick-answer"),n.data("id")),a=i.data("id"),u=f.questions[r],l=u.answers[a];n.data("answered")||(s.removeClass("quizzlestick-current quizzlestick-question-next quizzlestick-question-prev"),n.addClass("quizzlestick-current"),n.next().addClass("quizzlestick-question-next"),n.prev().addClass("quizzlestick-question-prev"),("single"===f.type||"which"===f.type)&&(i.addClass("quizzlestick-selected"),c.click()),"function"===e.type(l.onselect)&&l.onselect.apply(this,[l,n,u]),p.trigger("qsselect",[l,n,u,f]),i.trigger("qsselect",[l,n,u,f]))}}).on("tap click",".quizzlestick-finish",function(e){e.preventDefault(),p.data("complete")||(n.html(p.fumanchu("{{templates.progress}}",f)),(f.helpers.numanswers({},f)>=s.length||!f.mustanswer)&&(f.timelimit&&clearInterval(z),p.addClass("quizzlestick-complete").data("complete",!0),p.find(".quizzlestick-next").addClass("quizzlestick-hidden"),p.find(".quizzlestick-prev").addClass("quizzlestick-hidden"),s.removeClass("quizzlestick-current quizzlestick-question-next"),a.html(p.fumanchu("{{templates.result}}",f)).show().removeClass("quizzlestick-hidden"),f.api.send({id:f.id,action:"complete",state:f.state},f),p.trigger("qscomplete",[f])))}),e.each(f.questions,function(t,i){var s=0;i=e.extend(!0,{id:t},e.fn.quizzlestick.defaults.questiondefaults,i),!i.template&&f.templates.question&&(i.template=f.templates.question),e.each(i.answers,function(t,n){n=e.extend(!0,{id:t},e.fn.quizzlestick.defaults.answerdefaults,n),!n.template&&f.templates.answer&&(n.template=f.templates.answer),"which"===f.type&&(n.correct=!0),n.correct&&i.correct.push(t),n.correct&&parseInt(n.points,10)<=0&&"which"!==f.type&&(n.points=1),("single"===f.type||"which"===f.type)&&n.points>s&&(s=parseInt(n.points,10)),i.answers[t]=n}),"single"!==f.type&&"which"!==f.type||!s||(f.state.maxpoints+=parseInt(s,10)),f.questions[t]=i}),f.questions){p.html(p.fumanchu(f.templates.scaffold,f)),t=p.find(".quizzlestick-questions"),s=p.find(".quizzlestick-question"),n=p.find(".quizzlestick-progress"),r=p.find(".quizzlestick-timer"),a=p.find(".quizzlestick-result-final"),u=p.find(".quizzlestick-start-screen"),c=p.find(".quizzlestick-check").eq(0),l=p.find(".quizzlestick-next").eq(0),o=p.find(".quizzlestick-prev").eq(0),d=p.find(".quizzlestick-finish").eq(0);var m=0,q=0;e.each(f.questions,function(t,i){s.eq(m).attr("data-id",t).data("id",t),""!=i.image&&s.eq(m).addClass("quizzlestick-image-question"),e.each(i.answers,function(e,t){s.eq(m).find(".quizzlestick-answer").eq(q).attr("data-id",e).data("id",e),""!=t.image&&s.eq(m).find(".quizzlestick-answer").eq(q).addClass("quizzlestick-image-answer"),q++}),q=0,m++}),a.hide(),s.length<2&&n.remove(),parseInt(f.timelimit,10)?t.hide().addClass("quizzlestick-hidden"):(r.remove(),u.remove()),p.find(".quizzlestick-check").hide(),"which"===f.type&&(f.nextdelay=f.nextdelay||500),f.mustanswer&&(p.find(".quizzlestick-next").hide(),p.find(".quizzlestick-prev").hide(),p.find(".quizzlestick-finish").hide()),s.eq(f.state.question).addClass("quizzlestick-current"),s.eq(f.state.question+1).addClass("quizzlestick-question-next")}return p.trigger("qsready",[f]),p})},complete:function(){return e(this).find(".quizzlestick-next").eq(-1).click(),this},next:function(){return e(this).find(".quizzlestick-question-current .quizzlestick-next").click(),this},prev:function(){return e(this).find(".quizzlestick-question-current .quizzlestick-prev").click(),this}};e.fn.quizzlestick=function(i){return t[i]?t[i].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof i&&i?(e.error("Method "+i+" does not exist on jQuery.quizzlestick"),this):t.quiz.apply(this,arguments)},e.fn.quizzlestick.defaults={classname:"",type:"single",id:"",title:"",description:"",timelimit:0,nextdelay:0,state:{question:0,time:0,points:0,maxpoints:0,answers:{}},mustanswer:!0,player:function(){},playonce:!1,order:"normal",maxquestions:0,questions:[],results:[],onstart:e.noop,oncomplete:e.noop,onselect:e.noop,onanswer:e.noop,oncorrect:e.noop,onincorrect:e.noop,ontimer:e.noop,onnext:e.noop,onprev:e.noop,onsend:e.noop,onready:e.noop,questiondefaults:{question:"",answers:[],onanswer:null,oncorrect:null,onincorrect:null,result:"",resultcorrect:"",resultincorrect:"",correct:[],total:0,friends:[]},answerdefaults:{answer:"",correct:!1,points:0,onselect:null,result:"",resultcorrect:"",resultincorrect:"",total:0,friends:[]},templates:{scaffold:'				<div class="quizzlestick-title">					{{templates.title}}				</div>				<div class="quizzlestick-description">					{{templates.description}}				</div>				<div class="quizzlestick-progress">					{{templates.progress}}				</div>				<div class="quizzlestick-timer">					{{templates.timer}}				</div>				<div class="quizzlestick-start-screen">					{{templates.timerstart}}				</div>				<ol class="quizzlestick-questions">					{{questions}}						<li class="quizzlestick-question">							{{question}}							<ul class="quizzlestick-answers">								{{answers}}									<li class="quizzlestick-answer">										<a href="#">{{answer}}</a>									</li>								{{/answers}}							</ul>							<div class="quizzlestick-result quizzlestick-result-question quizzlestick-hidden"></div>							{{templates.nextprev}}						</li>					{{/questions}}				</ol>				{{templates.toolbar}}				<div class="quizzlestick-result quizzlestick-result-final quizzlestick-hidden">					{{templates.result}}				</div>			',description:"				{{description}}			",title:"				{{title}}			",progress:'				Q: <span class="quizzlestick-current-num">{{helpers.currentquestion}}</span> 				of <span class="quizzlestick-total">{{helpers.numquestions}}</span>			',timer:'				<span class="quizzlestick-timer-time">{{helpers.remainingtime}}</span>				<div class="quizzlestick-timer-progress">					<div class="quizzlestick-timer-progress-bar" style="width:{{helpers.timerwidth}}%;"></div>				</div>			',timerstart:'				<button class="quizzlestick-start" type="button">Start</button>			',result:'				<div class="quizzlestick-result-text">					{{helpers.getresult}}				</div>				{{templates.share}}			',questions:"				{{questions}}			",question:'				<li class="quizzlestick-question">					{{question}}					<ul class="quizzlestick-answers">						{{answers}}							<li class="quizzlestick-answer">								<a href="#">{{answer}}</a>							</li>						{{/answers}}					</ul>					<div class="quizzlestick-result quizzlestick-result-question quizzlestick-hidden"></div>				</li>			',answer:'				<li class="quizzlestick-answer">					<a href="#">{{answer}}</a>				</li>			',toolbar:'				<div class="quizzlestick-toolbar">					<a class="quizzlestick-check quizzlestick-hidden" href="#">Check answer</a>				</div>',nextprev:'				<div class="quizzlestick-nextprev">					<a class="quizzlestick-prev quizzlestick-hidden" href="#">Previous</a>					<a class="quizzlestick-next quizzlestick-hidden" href="#">Next</a>					<a class="quizzlestick-finish quizzlestick-hidden" href="#">Results</a>				</div>			',correct:'				<div class="quizzlestick-response-correct">Correct!</div>			',incorrect:'				<div class="quizzlestick-response-incorrect">Wrong!</div>			',share:""},helpers:{time:function(e,t){var i=Math.floor(t.state.time/1e3),s=Math.floor(i/60),n=Math.floor(s/60),r="";return i-=60*s,s-=60*n,n&&(r+=(10>n?"0"+n:n)+":"),r+=(10>s?"0"+s:s)+":",r+=10>i?"0"+i:i},timerwidth:function(e,t){var i=100/t.timelimit*t.state.time;return isNaN(i)&&(i=0),i},remainingtime:function(e,t){var i=Math.floor((t.timelimit-t.state.time)/1e3),s=Math.floor(i/60),n=Math.floor(s/60),r="";return i-=60*s,s-=60*n,n&&(r+=(10>n?"0"+n:n)+":"),r+=(10>s?"0"+s:s)+":",r+=10>i?"0"+i:i},getresult:function(t,i){if(!e(this).data("complete"))return"";if("array"===e.type(i.results)){i.results.sort(function(e,t){return parseInt(e.points,10)>parseInt(t.points,10)?1:-1});for(var s in i.results)if(i.state.points<=parseInt(i.results[s].points,10))return i.results[s]}return"string"===e.type(i.results)?i.results:"You scored <strong>{{state.points}}</string> out of <strong>{{state.maxpoints}}</strong>"},getresultimage:function(){var t=e(this).find(".quizzlestick-result-final img"),i=e(this).find(".quizzlestick-result img");return t.length?t.eq(-1).attr("src"):i.length?i.eq(-1).attr("src"):""},numquestions:function(e,t){return t.helpers.getlength(t.questions)},currentquestion:function(e,t){return parseInt(t.state.question,10)+1},numanswers:function(e,t){var i=0;for(var s in t.state.answers)i++;return i},progresswidth:function(e,t){var i=100/t.helpers.getlength(t.questions)*t.helpers.getlength(t.state.answers);return isNaN(i)&&(i=0),i},totalanswers:function(e){return e.total},answertotal:function(e){return e.total},answerwidth:function(t,i,s){var n=0,r=0;return e.map(s.list,function(e){return n+=parseInt(e.total,10)}),r=100/n*parseInt(t.total,10),isNaN(r)&&(r=0),r},numberformat:function(e){return""+e},getlength:function(t){var i=0;if("object"===e.type(t))for(var s in t)t.hasOwnProperty(s)&&i++;else t.length&&(i=t.length);return i}},api:{send:function(e,t){console.log(e),console.log(t)}}},e(document).ready(function(){e("[data-quizzlestick]").quizzlestick()})}(jQuery),function(e){e.fumanchu=function(t,i,s,n){var r=this;if(e.fumanchu.regex||(e.fumanchu.register("{{","}}"),e.fumanchu.register("__",function(e){return escape(e)}),e.fumanchu.register("{{round:","}}",function(e){return Math.round(e)}),e.fumanchu.register("{{2dp:","}}",function(e){return Number(e).toFixed(2)})),e.fumanchu.context=i||{},e.fumanchu.fallback=s||i,e.fumanchu.args=n||{},"undefined"===e.type(t))return"";if("function"===e.type(t)&&(t=t.apply(r,[e.fumanchu.context,e.fumanchu.fallback,e.fumanchu.args])),"object"===e.type(t))if(t.template)e.fumanchu.context=t,t=t.template;else try{t=t.html()}catch(a){}return t.toString().replace(e.fumanchu.regex,function(t,i,s,a,u,c){var l=e.fumanchu.getpath(s,e.fumanchu.context,e.fumanchu.fallback),o="",d=c||e.fumanchu.templates[s]||e('[data-template="'+s+'"]').html();return!e.fumanchu.templates[s]&&d&&(e.fumanchu.templates[s]=d),"object"===e.type(l)&&l.template?o=r.fumanchu(l.template,l,e.fumanchu.fallback,n):"array"===e.type(l)||"object"===e.type(l)?e.each(l,function(t,i){"object"===e.type(i)&&(!i.template&&d&&(i.template=d),e.fumanchu.context=i),o+=r.fumanchu(i,e.fumanchu.context,e.fumanchu.fallback,{list:l,index:t})}):"function"===e.type(l)?o=l.apply(r,[e.fumanchu.context,e.fumanchu.fallback,n]):"number"===e.type(l)?o=e.fumanchu.numberformat(l,e.fumanchu.fallback):"boolean"===e.type(l)?o=l?"1":"0":"string"===e.type(l)&&(o=l),o=e.fumanchu.delimiters[i].callback(o,l,d),r.fumanchu(o,e.fumanchu.context,e.fumanchu.fallback,e.fumanchu.args)})},e.fumanchu.getpath=function(t,i,s){return t=t.split("."),4==t.length&&i&&i[t[0]]&&i[t[0]][t[1]]&&i[t[0]][t[1]][t[2]]&&"undefined"!==e.type(i[t[0]][t[1]][t[2]][t[3]])?i[t[0]][t[1]][t[2]][t[3]]:3==t.length&&i&&i[t[0]]&&i[t[0]][t[1]]&&"undefined"!==e.type(i[t[0]][t[1]][t[2]])?i[t[0]][t[1]][t[2]]:2==t.length&&i&&i[t[0]]&&"undefined"!==e.type(i[t[0]][t[1]])?i[t[0]][t[1]]:1==t.length&&i&&"undefined"!==e.type(i[t[0]])?i[t[0]]:s&&i!==s?e.fn.fumanchu.getpath(t.join("."),s):""},e.fumanchu.regex=null,e.fumanchu.delimiters={},e.fumanchu.register=function(){if(arguments&&arguments.length){var t=arguments[0],i=!1,s=!1;3===arguments.length?(i=arguments[1],s=arguments[2]):2===arguments.length&&("string"===e.type(arguments[1])&&(i=arguments[1]),"function"===e.type(arguments[1])&&(s=arguments[1])),"string"===e.type(t)&&(i||(i=t),"function"!==e.type(s)&&(s=function(e){return e}),e.fumanchu.delimiters[t]={open:t,close:i,callback:s},e.fumanchu.regex=new RegExp("("+e.map(e.fumanchu.delimiters,function(e){return e.open}).join("|")+")([a-z0-9.]+)("+e.map(e.fumanchu.delimiters,function(e){return e.close}).join("|")+")((.*?)(?:\\1)/\\2(?:\\3))?","gim"))}},e.fumanchu.templates={},e.fumanchu.numberformat=function(e){return""+e},e(document).ready(function(){e("[data-template]").each(function(){e.fumanchu.templates[e(this).data("template")]=e(this).html()})}),e.fn.fumanchu=e.fumanchu}(jQuery);